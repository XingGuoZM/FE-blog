åŸæ–‡åœ°å€ï¼š[Microâ€†Frontends extending the microservice idea to frontend development](https://micro-frontends.org/)

ç”±å¤šä¸ªæ‹¥æœ‰ç‹¬ç«‹å‘å¸ƒèƒ½åŠ›çš„å›¢é˜Ÿæ„å»ºç°ä»£Webåº”ç”¨ç¨‹åºçš„æŠ€æœ¯ï¼Œç­–ç•¥å’Œæ–¹æ³•ã€‚

## ä»€ä¹ˆæ˜¯å¾®å‰ç«¯ï¼Ÿ
"å¾®å‰ç«¯"ä¸€è¯æœ€æ—©äº2016å¹´åº•å‡ºç°åœ¨[ThoughtWorks Technology Radar](https://www.thoughtworks.com/radar/techniques/micro-frontends)ä¸Šã€‚å®ƒå°†å¾®æœåŠ¡çš„æ¦‚å¿µæ‰©å±•åˆ°äº†å‰ç«¯ä¸–ç•Œã€‚å½“å‰çš„è¶‹åŠ¿æ˜¯æ„å»ºä¸€ä¸ªç‰¹æ€§ä¸°å¯Œä¸”åŠŸèƒ½å¼ºå¤§çš„æµè§ˆå™¨åº”ç”¨ç¨‹åºï¼ˆåˆåå•é¡µåº”ç”¨ç¨‹åºï¼‰ï¼Œè¯¥åº”ç”¨ç¨‹åºæœªåº”ç”¨å¾®æœåŠ¡æ¶æ„ã€‚éšç€æ—¶é—´çš„æµé€ï¼Œé€šå¸¸ç”±ç‹¬ç«‹å›¢é˜Ÿå¼€å‘çš„å‰ç«¯å±‚ä¼šä¸æ–­å¢é•¿ï¼Œå¹¶ä¸”å˜å¾—è¶Šæ¥è¶Šéš¾ä»¥ç»´æŠ¤ã€‚è¿™å°±æ˜¯æˆ‘ä»¬æ‰€è°“çš„[å·¨çŸ³åº”ç”¨](https://www.youtube.com/watch?v=pU1gXA0rfwc)ã€‚

å¾®å‰ç«¯èƒŒåçš„æƒ³æ³•æ˜¯å°†ç½‘ç«™æˆ–Webåº”ç”¨ç¨‹åºè§†ä¸ºç”±æ¯ä¸ªç‹¬ç«‹å›¢é˜Ÿæ‹¥æœ‰åŠŸèƒ½çš„åˆé›†ã€‚æ¯ä¸ªå›¢é˜Ÿéƒ½æœ‰è‡ªå·±å…³å¿ƒå’Œä¸“é•¿çš„ä¸åŒä¸šåŠ¡æˆ–ä»»åŠ¡é¢†åŸŸã€‚å•ä¸ªå›¢é˜Ÿæ˜¯è·¨èŒèƒ½çš„ï¼Œä»æ•°æ®åº“åˆ°ç”¨æˆ·ç•Œé¢ï¼Œç«¯åˆ°ç«¯åœ°å¼€å‘å…¶åŠŸèƒ½ã€‚

ä½†æ˜¯ï¼Œè¿™ä¸ªæƒ³æ³•å¹¶ä¸æ–°å¥‡ã€‚å®ƒä¸[è‡ªåŒ…å«ç³»ç»Ÿ](http://scs-architecture.org/)æ¦‚å¿µæœ‰å¾ˆå¤šå…±åŒç‚¹ã€‚è¿‡å»ï¼Œç±»ä¼¼çš„æ–¹æ³•è¢«ç§°ä¸º[å‚ç›´ç³»ç»Ÿçš„å‰ç«¯é›†æˆ](https://dev.otto.de/2014/07/29/scaling-with-microservices-and-vertical-decomposition/)ã€‚ä½†æ˜¯å¾®å‰ç«¯æ˜¾ç„¶æ˜¯ä¸€ä¸ªæ›´å‹å¥½ï¼Œæ›´å°å·§çš„æœ¯è¯­ã€‚

### å·¨çŸ³åº”ç”¨
![Monolithic Frontends](https://micro-frontends.org/ressources/diagrams/organisational/monolith-frontback-microservices.png)

### å‚ç›´ç»„ç»‡
![End-To-End Teams with Micro Frontends](https://micro-frontends.org/ressources/diagrams/organisational/verticals-headline.png)

## ä»€ä¹ˆæ˜¯ç°ä»£webåº”ç”¨ï¼Ÿ
åœ¨ä»‹ç»ä¸­ï¼Œæˆ‘ä½¿ç”¨äº†"æ„å»ºç°ä»£webåº”ç”¨ç¨‹åº"ä¸€è¯ã€‚è®©æˆ‘ä»¬å®šä¹‰ä¸æ­¤æœ¯è¯­ç›¸å…³çš„å‡è®¾ã€‚

å°†è¿™ä¸ªä¸œè¥¿æ”¾åˆ°æ›´å¤§çš„è§†é‡ä¸­ï¼Œ[Aral Balkan](https://ar.al/)å†™è¿‡ä¸€ç¯‡åšå®¢æ–‡ç« ï¼Œä»‹ç»äº†ä»–çš„[Documents-to-Applications Continuum](https://ar.al/notes/the-documents-to-applications-continuum/)ã€‚ä»–æå‡ºäº†æ»‘åŠ¨æ¯”ä¾‹å°ºçš„æ¦‚å¿µï¼Œå…¶ä¸­åœ¨å·¦ä¾§æ˜¯ä¸€ä¸ªç”±é™æ€æ–‡æ¡£æ„å»ºä¸”é€šè¿‡é“¾æ¥è¿æ¥çš„ç«™ç‚¹ï¼Œè€Œåœ¨å³ä¾§æ˜¯ä¸€ä¸ªçº¯è¡Œä¸ºé©±åŠ¨çš„ï¼Œæ— å†…å®¹çš„åº”ç”¨ç¨‹åºï¼Œä¾‹å¦‚åœ¨çº¿ç…§ç‰‡ç¼–è¾‘å™¨ã€‚

å¦‚æœæ‚¨å°†é¡¹ç›®æ”¾ç½®åœ¨æ­¤èŒƒå›´çš„å·¦ä¾§ï¼Œåˆ™éå¸¸é€‚åˆåœ¨WebæœåŠ¡å™¨çº§åˆ«è¿›è¡Œé›†æˆã€‚ä½¿ç”¨æ­¤æ¨¡å‹ï¼ŒæœåŠ¡å™¨ä»æ„æˆç”¨æˆ·è¯·æ±‚çš„é¡µé¢çš„æ‰€æœ‰ç»„ä»¶ä¸­æ”¶é›†å¹¶è¿æ¥HTMLå­—ç¬¦ä¸²ã€‚é€šè¿‡ä»æœåŠ¡å™¨é‡æ–°åŠ è½½é¡µé¢æˆ–é€šè¿‡ajaxæ›¿æ¢é¡µé¢çš„ä¸€éƒ¨åˆ†æ¥å®Œæˆæ›´æ–°ã€‚[Gustaf Nilsson Kotte](https://twitter.com/gustaf_nk/)æ’°å†™äº†æœ‰å…³æ­¤ä¸»é¢˜çš„[ç»¼åˆæ–‡ç« ](https://gustafnk.github.io/microservice-websites/)ã€‚

å½“æ‚¨çš„ç”¨æˆ·ç•Œé¢å¿…é¡»æä¾›å®æ—¶åé¦ˆï¼ˆå³ä½¿æ˜¯åœ¨ä¸å¯é çš„è¿æ¥ä¸Šï¼‰æ—¶ï¼Œä»…ç”±æœåŠ¡å™¨æ¸²æŸ“çš„ç½‘ç«™å·²ä¸å†æ»¡è¶³è¦æ±‚ã€‚è¦å®ç°[Optimistic UI](https://www.smashingmagazine.com/2016/11/true-lies-of-optimistic-user-interfaces/)æˆ–[Skeleton Screens](http://www.lukew.com/ff/entry.asp1797)ï¼Œæ‚¨è¿˜éœ€è¦èƒ½å¤Ÿåœ¨è®¾å¤‡æœ¬èº«ä¸Šæ›´æ–°ç”¨æˆ·ç•Œé¢ã€‚Googleçš„æœ¯è¯­[Progressive Web Apps](https://developers.google.com/web/progressive-web-apps/)æ°å¦‚å…¶åˆ†åœ°æè¿°äº†æˆä¸ºç½‘ç»œè‰¯å¥½å…¬æ°‘ï¼ˆæ¸è¿›å¼å¢å¼ºåŠŸèƒ½ï¼‰çš„å¹³è¡¡è¡Œä¸ºï¼ŒåŒæ—¶è¿˜æä¾›äº†ç±»ä¼¼Appçš„åŠŸèƒ½è¡¨ç°ã€‚è¿™ç§åº”ç”¨ç¨‹åºä½äºsite-app-continuumä¸­é—´çš„æŸä¸ªä½ç½®ã€‚åœ¨è¿™é‡Œï¼Œä»…åŸºäºæœåŠ¡å™¨çš„è§£å†³æ–¹æ¡ˆå·²ç»ä¸èƒ½æ»¡è¶³è¦æ±‚ã€‚æˆ‘ä»¬å¿…é¡»å°†é›†æˆè½¬ç§»åˆ°æµè§ˆå™¨ä¸­ï¼Œè¿™æ˜¯æœ¬æ–‡çš„é‡ç‚¹ã€‚

## å¾®å‰ç«¯èƒŒåçš„æ ¸å¿ƒæ€æƒ³
- æŠ€æœ¯ç‹¬ç«‹
æ¯ä¸ªå›¢é˜Ÿéƒ½åº”è¯¥èƒ½å¤Ÿé€‰æ‹©å’Œå‡çº§å…¶æŠ€æœ¯æ ˆï¼Œè€Œä¸å¿…ä¸å…¶ä»–å›¢é˜Ÿè¿›è¡Œåè°ƒã€‚è‡ªå®šä¹‰å…ƒç´ æ˜¯ä¸€ç§éšè—å®ç°ç»†èŠ‚ï¼ŒåŒæ—¶ä¸ºå…¶ä»–äººæä¾›ä¸­ç«‹æ¥å£çš„å¥½æ–¹æ³•ã€‚

- å›¢é˜Ÿä»£ç éš”ç¦»
å³ä½¿æ‰€æœ‰å›¢é˜Ÿéƒ½ä½¿ç”¨ç›¸åŒçš„æ¡†æ¶ï¼Œä¹Ÿä¸è¦å…±äº«è¿è¡Œæ—¶é—´ã€‚æ„å»ºç‹¬ç«‹çš„ç‹¬ç«‹åº”ç”¨ç¨‹åºã€‚ä¸è¦ä¾èµ–å…±äº«çŠ¶æ€æˆ–å…¨å±€å˜é‡ã€‚

- å»ºç«‹å›¢é˜Ÿå‰ç¼€
åŒæ„å°šæ— æ³•éš”ç¦»çš„å‘½åçº¦å®šã€‚å‘½åç©ºé—´CSSï¼Œäº‹ä»¶ï¼Œæœ¬åœ°å­˜å‚¨å’ŒCookiesï¼Œä»¥é¿å…å†²çªå¹¶é˜æ˜æ‰€æœ‰æƒã€‚

- é€šè¿‡è‡ªå®šä¹‰APIæ”¯æŒæœ¬æœºæµè§ˆå™¨åŠŸèƒ½
ä½¿ç”¨[æµè§ˆå™¨äº‹ä»¶è¿›è¡Œé€šä¿¡](https://micro-frontends.org/#parent-child-communication--dom-modification)è€Œä¸æ˜¯æ„å»ºå…¨å±€çš„PubSubç³»ç»Ÿã€‚å¦‚æœç¡®å®éœ€è¦æ„å»ºè·¨å›¢é˜ŸAPIï¼Œè¯·å°½é‡ç®€å•ã€‚

- å»ºç«‹å¼¹æ€§ç«™ç‚¹
å³ä½¿JavaScriptå¤±è´¥æˆ–å°šæœªæ‰§è¡Œï¼Œæ‚¨çš„åŠŸèƒ½ä¹Ÿåº”è¯¥å¾ˆæœ‰ç”¨ã€‚ä½¿ç”¨[é€šç”¨æ¸²æŸ“](https://micro-frontends.org/#serverside-rendering--é€šç”¨æ¸²æŸ“)å’Œæ¸è¿›å¢å¼ºåŠŸèƒ½å¯æ”¹å–„æ„ŸçŸ¥æ€§èƒ½ã€‚

## DOMæ˜¯API
[è‡ªå®šä¹‰å…ƒç´ ](https://developers.google.com/web/fundamentals/getting-started/primers/customelements)ï¼Œæ˜¯Webç»„ä»¶è§„èŒƒä¸­çš„äº’æ“ä½œæ€§ï¼Œæ˜¯é›†æˆåˆ°æµè§ˆå™¨ä¸­çš„ä¸€ä¸ªå¾ˆå¥½çš„åŸå§‹æ–¹æ³•ã€‚æ¯ä¸ªå›¢é˜Ÿéƒ½ä½¿ç”¨è‡ªå·±é€‰æ‹©çš„ç½‘ç»œæŠ€æœ¯æ¥æ„å»ºå…¶ç»„ä»¶ï¼Œå¹¶å°†å…¶åŒ…è£…åœ¨ä¸€ä¸ªè‡ªå®šä¹‰å…ƒç´ ä¸­ï¼ˆä¾‹å¦‚\<order-minicart\> \</order-minicart\\>ï¼‰ã€‚è¯¥ç‰¹å®šå…ƒç´ ï¼ˆæ ‡ç­¾ï¼Œå±æ€§å’Œäº‹ä»¶ï¼‰çš„DOMè§„èŒƒå……å½“å…¶ä»–å›¢é˜Ÿçš„åˆçº¦æˆ–å…¬å…±APIã€‚ä¼˜ç‚¹æ˜¯ä»–ä»¬å¯ä»¥ä½¿ç”¨ç»„ä»¶åŠå…¶åŠŸèƒ½ï¼Œè€Œæ— éœ€äº†è§£å®ç°ã€‚ä»–ä»¬åªéœ€è¦èƒ½å¤Ÿä¸DOMäº¤äº’å³å¯ã€‚

ä½†æ˜¯ï¼Œä»…è‡ªå®šä¹‰å…ƒç´ å¹¶ä¸èƒ½æ»¡è¶³æˆ‘ä»¬æ‰€æœ‰éœ€æ±‚ã€‚ä¸ºäº†è§£å†³æ¸è¿›å¢å¼ºï¼Œé€šç”¨æ¸²æŸ“æˆ–è·¯ç”±é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦å…¶ä»–è½¯ä»¶ã€‚

è¯¥é¡µé¢åˆ†ä¸ºä¸¤ä¸ªä¸»è¦åŒºåŸŸã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å°†è®¨è®º[é¡µé¢ç»„æˆ](https://micro-frontends.org/#page-composition)-å¦‚ä½•æ ¹æ®ä¸åŒå›¢é˜Ÿæ‹¥æœ‰çš„ç»„ä»¶æ¥ç»„è£…é¡µé¢ã€‚ä¹‹åï¼Œæˆ‘ä»¬å°†å±•ç¤ºå®ç°å®¢æˆ·ç«¯[é¡µé¢è½¬æ¢](https://micro-frontends.org/#page-transition)çš„ç¤ºä¾‹ã€‚

## é¡µé¢ç»„æˆ
é™¤äº†ä½¿ç”¨ä¸åŒæ¡†æ¶æœ¬èº«ç¼–å†™çš„å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ä»£ç é›†æˆä¹‹å¤–ï¼Œè¿˜åº”è¯¥è®¨è®ºå¾ˆå¤šé™„å¸¦ä¸»é¢˜ï¼šéš”ç¦»jsçš„æœºåˆ¶ï¼Œé¿å…csså†²çªï¼ŒæŒ‰éœ€åŠ è½½èµ„æºï¼Œåœ¨å›¢é˜Ÿä¹‹é—´å…±äº«å…¬å…±èµ„æºï¼Œå¤„ç†æ•°æ®è·å– å¹¶è€ƒè™‘ä¸ºç”¨æˆ·æä¾›è‰¯å¥½çš„åŠ è½½çŠ¶æ€ã€‚ æˆ‘ä»¬å°†ä¸€æ­¥ä¸€æ­¥åœ°æ¶‰åŠè¿™äº›ä¸»é¢˜ã€‚

## åŸºæœ¬åŸå‹
æ‹–æ‹‰æœºå•†åº—çš„ä¸åŒå‹å·äº§å“é¡µé¢å°†ä½œä¸ºä»¥ä¸‹ç¤ºä¾‹çš„åŸºç¡€ã€‚

å®ƒå…·æœ‰ä¸€ä¸ªå˜ä½“é€‰æ‹©å™¨ï¼Œå¯ä»¥åœ¨ä¸‰ç§ä¸åŒçš„æ‹–æ‹‰æœºå‹å·ä¹‹é—´åˆ‡æ¢ã€‚ æ›´æ”¹äº§å“å›¾ç‰‡æ—¶ï¼Œåç§°ï¼Œä»·æ ¼å’Œå»ºè®®ä¼šæ›´æ–°ã€‚ è¿˜æœ‰ä¸€ä¸ªè´­ä¹°æŒ‰é’®ï¼Œå°†é€‰æ‹©çš„å˜ä½“æ·»åŠ åˆ°è´­ç‰©ç¯®ï¼Œå¹¶åœ¨é¡¶éƒ¨å¢åŠ ä¸€ä¸ªè¿·ä½ è´­ç‰©ç¯®ï¼Œå¹¶ç›¸åº”åœ°è¿›è¡Œæ›´æ–°ã€‚

![Example 0 - Product Page - Plain JS](https://micro-frontends.org/ressources/video/model-store-0.gif)

[try in browser](https://micro-frontends.org/0-model-store/) & [inspect the code](https://github.com/neuland/micro-frontends/tree/master/0-model-store)

æ‰€æœ‰HTMLéƒ½æ˜¯ä½¿ç”¨çº¯JavaScriptå’Œæ²¡æœ‰ä¾èµ–æ€§çš„ES6æ¨¡æ¿å­—ç¬¦ä¸²åœ¨å®¢æˆ·ç«¯ç”Ÿæˆçš„ã€‚è¯¥ä»£ç ä½¿ç”¨ç®€å•çš„çŠ¶æ€/æ ‡è®°åˆ†ç¦»ï¼Œå¹¶åœ¨æ¯æ¬¡æ›´æ”¹æ—¶é‡æ–°å‘ˆç°æ•´ä¸ªHTMLå®¢æˆ·ç«¯-æ— éœ€èŠ±å“¨çš„DOMåŒºåˆ«ï¼Œä¹Ÿæ²¡æœ‰é€šç”¨æ¸²æŸ“ã€‚ä¹Ÿæ²¡æœ‰å›¢é˜ŸåŒºåˆ†-[ä»£ç ](https://github.com/neuland/micro-frontends/tree/master/0-model-store)å†™åœ¨ä¸€ä¸ªjs/cssæ–‡ä»¶ä¸­ã€‚

## å®¢æˆ·ç«¯é›†æˆ
åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œé¡µé¢åˆ†ä¸ºä¸‰ä¸ªå›¢é˜Ÿæ‹¥æœ‰çš„å•ç‹¬çš„ç»„ä»¶/ç‰‡æ®µã€‚Team Checkoutï¼ˆè“è‰²ï¼‰ç°åœ¨è´Ÿè´£ä¸è´­ä¹°è¿‡ç¨‹æœ‰å…³çš„æ‰€æœ‰äº‹æƒ…ï¼Œå³â€œè´­ä¹°â€æŒ‰é’®å’Œè¿·ä½ è´­ç‰©ç¯®ã€‚Team Inspireï¼ˆç»¿è‰²ï¼‰åœ¨æ­¤é¡µé¢ä¸Šç®¡ç†äº§å“æ¨èã€‚è¯¥é¡µé¢æœ¬èº«å½’å›¢é˜Ÿäº§å“ï¼ˆçº¢è‰²ï¼‰æ‰€æœ‰ã€‚

![Example 1 - Product Page - Composition](https://micro-frontends.org/ressources/screen/three-teams.png)

[try in browser](https://micro-frontends.org/1-composition-client-only/) & [inspect the code](https://github.com/neuland/micro-frontends/tree/master/1-composition-client-only)

å›¢é˜Ÿäº§å“å†³å®šè¦åŒ…æ‹¬çš„åŠŸèƒ½ä»¥åŠåœ¨å¸ƒå±€ä¸­çš„ä½ç½®ã€‚è¯¥é¡µé¢åŒ…å«å›¢é˜Ÿäº§å“æœ¬èº«å¯ä»¥æä¾›çš„ä¿¡æ¯ï¼Œä¾‹å¦‚äº§å“åç§°ï¼Œå›¾åƒå’Œå¯ç”¨çš„å˜ä½“ã€‚ä½†æ˜¯å®ƒä¹ŸåŒ…æ‹¬å…¶ä»–å›¢é˜Ÿçš„ç‰‡æ®µï¼ˆè‡ªå®šä¹‰å…ƒç´ ï¼‰ã€‚

## å¦‚ä½•åˆ›å»ºè‡ªå®šä¹‰å…ƒç´ ï¼Ÿ
è®©æˆ‘ä»¬ä»¥â€œè´­ä¹°â€æŒ‰é’®ä¸ºä¾‹ã€‚Team ProductåŒ…å«æŒ‰é’®ï¼Œåªéœ€å°†\<blue-buy sku =â€œt_porscheâ€\> \</blue-buy\>æ·»åŠ åˆ°æ ‡è®°ä¸­çš„æ‰€éœ€ä½ç½®å³å¯ã€‚ä¸ºæ­¤ï¼ŒTeam Checkoutå¿…é¡»åœ¨é¡µé¢ä¸Šæ³¨å†Œè“è‰²è´­ä¹°å…ƒç´ ã€‚
```js
class BlueBuy extends HTMLElement {
  connectedCallback() {
    this.innerHTML = `<button type="button">buy for 66,00 â‚¬</button>`;
  }

  disconnectedCallback() { ... }
}

window.customElements.defineï¼ˆ'blue-buy'ï¼ŒBlueBuyï¼‰;
```
ç°åœ¨ï¼Œæ¯æ¬¡æµè§ˆå™¨é‡åˆ°ä¸€ä¸ªæ–°çš„blue-buyæ ‡ç­¾æ—¶ï¼Œéƒ½ä¼šè°ƒç”¨connectedCallbackã€‚è¿™æ˜¯å¯¹è‡ªå®šä¹‰å…ƒç´ çš„æ ¹DOMèŠ‚ç‚¹çš„å¼•ç”¨ã€‚å¯ä»¥ä½¿ç”¨æ ‡å‡†DOMå…ƒç´ ï¼ˆä¾‹å¦‚innerHTMLæˆ–getAttribute()ï¼‰çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ã€‚

![Custom Element in Action](https://micro-frontends.org/ressources/video/custom-element.gif)

å‘½åå…ƒç´ æ—¶ï¼Œè§„èŒƒå®šä¹‰çš„å”¯ä¸€è¦æ±‚æ˜¯åç§°å¿…é¡»åŒ…å«çŸ­åˆ’çº¿ï¼ˆ-ï¼‰ï¼Œä»¥ä¿æŒä¸å³å°†åˆ°æ¥çš„æ–°HTMLæ ‡ç­¾çš„å…¼å®¹æ€§ã€‚åœ¨æ¥ä¸‹æ¥çš„ç¤ºä¾‹ä¸­ï¼Œä½¿ç”¨äº†å‘½åçº¦å®š[team_color]-[feature]ã€‚å›¢é˜Ÿå‘½åç©ºé—´å¯é˜²æ­¢åç§°å†²çªï¼Œå› æ­¤åªéœ€æŸ¥çœ‹DOMï¼Œå°±å¯ä»¥æ¸…æ¥šåœ°äº†è§£åŠŸèƒ½çš„æ‰€æœ‰æƒã€‚

## çˆ¶å­é€šä¿¡ / DOMä¿®æ”¹
å½“ç”¨æˆ·åœ¨å˜é‡é€‰æ‹©å™¨ä¸­é€‰æ‹©å¦ä¸€å°æ‹–æ‹‰æœºæ—¶ï¼Œå¿…é¡»ç›¸åº”åœ°æ›´æ–°è´­ä¹°æŒ‰é’®ã€‚è¦å®ç°æ­¤å›¢é˜Ÿäº§å“ï¼Œåªéœ€ä»DOMä¸­åˆ é™¤ç°æœ‰å…ƒç´ ï¼Œç„¶åæ’å…¥ä¸€ä¸ªæ–°å…ƒç´ å³å¯ã€‚
```js
container.innerHTML;
// => <blue-buy sku="t_porsche">...</blue-buy>
container.innerHTML = '<blue-buy sku="t_fendt"></blue-buy>';
```
åŒæ­¥è°ƒç”¨æ—§å…ƒç´ çš„connectedCallbackï¼Œä»¥ä½¿è¯¥å…ƒç´ æœ‰æœºä¼šæ¸…ç†è¯¸å¦‚äº‹ä»¶ä¾¦å¬å™¨ä¹‹ç±»çš„ä¸œè¥¿ã€‚ä¹‹åï¼Œå°†è°ƒç”¨æ–°åˆ›å»ºçš„t_fendtå…ƒç´ çš„connectedCallbackã€‚

å¦ä¸€ä¸ªæ€§èƒ½æ›´é«˜çš„é€‰é¡¹æ˜¯ä»…æ›´æ–°ç°æœ‰å…ƒç´ ä¸Šçš„skuå±æ€§ã€‚
```js
document.querySelector('blue-buy').setAttribute('sku', 't_fendt');
```

å¦‚æœTeam Productä½¿ç”¨å…·æœ‰DOMå·®å¼‚åŠŸèƒ½çš„æ¨¡æ¿å¼•æ“ï¼ˆå¦‚Reactï¼‰ï¼Œåˆ™å°†ç”±ç®—æ³•è‡ªåŠ¨å®Œæˆã€‚

![Custom Element Attribute Change](https://micro-frontends.org/ressources/video/custom-element-attribute.gif)

ä¸ºäº†æ”¯æŒè¿™ä¸€ç‚¹ï¼ŒCustomå…ƒç´ å¯ä»¥å®ç°attributeChangedCallbackå¹¶æŒ‡å®šè§‚å¯Ÿåˆ°çš„å±æ€§åˆ—è¡¨ï¼Œåº”ä¸ºå…¶è§¦å‘æ­¤å›è°ƒ

```js
const prices = {
  t_porsche: '66,00 â‚¬',
  t_fendt: '54,00 â‚¬',
  t_eicher: '58,00 â‚¬',
};

class BlueBuy extends HTMLElement {
  static get observedAttributes() {
    return ['sku'];
  }
  connectedCallback() {
    this.render();
  }
  render() {
    const sku = this.getAttribute('sku');
    const price = prices[sku];
    this.innerHTML = `<button type="button">buy for ${price}</button>`;
  }
  attributeChangedCallback(attr, oldValue, newValue) {
    this.render();
  }
  disconnectedCallback() {...}
}

window.customElements.define('blue-buy', BlueBuy);
```

ä¸ºäº†é¿å…é‡å¤ï¼Œå¼•å…¥äº†render()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•åœ¨connectedCallbackå’ŒattributeChangedCallbackä¸­è¢«è°ƒç”¨ã€‚è¿™ç§æ–¹æ³•æ”¶é›†æ‰€éœ€çš„æ•°æ®ï¼Œè€ŒinnerHTMLå°±æ˜¯æ–°çš„æ ‡è®°ã€‚å½“å†³å®šåœ¨Custom Elementä¸­ä½¿ç”¨æ›´å¤æ‚çš„æ¨¡æ¿å¼•æ“æˆ–æ¡†æ¶æ—¶ï¼Œè¿™é‡Œå°±æ˜¯åˆå§‹åŒ–ä»£ç çš„åœ°æ–¹ã€‚

## æµè§ˆå™¨æ”¯æŒ
ä¸Šé¢çš„ç¤ºä¾‹ä½¿ç”¨äº†[å½“å‰æ”¯æŒChromeï¼ŒSafariå’ŒOperaè‡ªå®šä¹‰å…ƒç´ V1è§„èŒƒ](http://caniuse.com/#feat=custom-elementsv1)ã€‚ä½†æ˜¯ï¼Œä½¿ç”¨[document-register-element](https://github.com/WebReflection/document-register-element)å¯ä»¥ä½¿ç”¨è½»é‡çº§ä¸”ç»å†è¿‡æˆ˜æ–—è€ƒéªŒçš„polyfillæ¥ä½¿å…¶åœ¨æ‰€æœ‰æµè§ˆå™¨ä¸­éƒ½èƒ½æ­£å¸¸å·¥ä½œã€‚åœ¨å¹•åï¼Œå®ƒä½¿ç”¨[å¹¿æ³›æ”¯æŒçš„](http://caniuse.com/#feat=mutationobserver)Mutation Observer APIï¼Œå› æ­¤åœ¨åå°ä¸ä¼šå‡ºç°éª‡äººçš„DOMæ ‘ã€‚

## æ¡†æ¶å…¼å®¹æ€§
ç”±äºè‡ªå®šä¹‰å…ƒç´ æ˜¯ä¸€ç§ç½‘ç»œæ ‡å‡†ï¼Œå› æ­¤æ‰€æœ‰ä¸»æµçš„JavaScriptæ¡†æ¶ï¼ˆå¦‚Angularï¼ŒReactï¼ŒPreactï¼ŒVueæˆ–Hyperappï¼‰éƒ½æ”¯æŒå®ƒä»¬ã€‚ ä½†æ˜¯å½“æ‚¨è¿›å…¥ç»†èŠ‚æ—¶ï¼ŒæŸäº›æ¡†æ¶ä¸­ä»ç„¶å­˜åœ¨ä¸€äº›å®ç°é—®é¢˜ã€‚åœ¨[æ— å¤„ä¸åœ¨çš„è‡ªå®šä¹‰å…ƒç´ ](https://custom-elements-everywhere.com/)[Rob Dodson](https://twitter.com/rob_dodson)æ±‡é›†äº†ä¸€ä¸ªå…¼å®¹æ€§æµ‹è¯•å¥—ä»¶ï¼Œç€é‡å¼ºè°ƒäº†å°šæœªè§£å†³çš„é—®é¢˜ã€‚

## çˆ¶å­æˆ–å…„å¼Ÿç»„ä»¶é€šä¿¡ / DOMäº‹ä»¶
ä½†æ˜¯ï¼Œå±æ€§ä¼ é€’ä¸è¶³ä»¥è¿›è¡Œæ‰€æœ‰äº¤äº’ã€‚åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œå½“ç”¨æˆ·å•å‡»â€œè´­ä¹°â€æŒ‰é’®æ—¶ï¼Œè¿·ä½ è´­ç‰©ç¯®åº”åˆ·æ–°ã€‚

è¿™ä¸¤ä¸ªç‰‡æ®µå‡ç”±Team Checkoutæ‹¥æœ‰ï¼ˆè“è‰²ï¼‰ï¼Œå› æ­¤å®ƒä»¬å¯ä»¥æ„å»ºæŸç§å†…éƒ¨JavaScript APIï¼Œè¯¥APIå¯ä½¿è¿·ä½ è´­ç‰©ç¯®çŸ¥é“ä½•æ—¶æŒ‰ä¸‹æŒ‰é’®ã€‚ä½†è¿™å°†è¦æ±‚ç»„ä»¶å®ä¾‹ç›¸äº’é€šä¿¡ï¼Œå¹¶ä¸”å†²çªéš”ç¦»ã€‚

è¾ƒå¹²å‡€çš„æ–¹æ³•æ˜¯ä½¿ç”¨PubSubæœºåˆ¶ï¼Œåœ¨è¯¥æœºåˆ¶ä¸­ï¼Œä¸€ä¸ªç»„ä»¶å¯ä»¥å‘å¸ƒæ¶ˆæ¯ï¼Œè€Œå…¶ä»–ç»„ä»¶å¯ä»¥è®¢é˜…ç‰¹å®šä¸»é¢˜ã€‚å¹¸è¿çš„æ˜¯ï¼Œæµè§ˆå™¨å†…ç½®äº†æ­¤åŠŸèƒ½ã€‚è¿™æ­£æ˜¯å•å‡»ï¼Œé€‰æ‹©æˆ–é¼ æ ‡æ‚¬åœä¹‹ç±»çš„æµè§ˆå™¨äº‹ä»¶çš„å·¥ä½œæ–¹å¼ã€‚é™¤äº†æœ¬æœºäº‹ä»¶ï¼Œè¿˜å¯ä»¥ä½¿ç”¨æ–°çš„CustomEventï¼ˆ...ï¼‰åˆ›å»ºæ›´é«˜çº§åˆ«çš„äº‹ä»¶ã€‚äº‹ä»¶å§‹ç»ˆä¸åˆ›å»º/è°ƒåº¦äº‹ä»¶çš„DOMèŠ‚ç‚¹ç›¸å…³ã€‚å¤§å¤šæ•°æœ¬æœºäº‹ä»¶è¿˜å…·æœ‰å†’æ³¡åŠŸèƒ½ã€‚è¿™æ ·å°±å¯ä»¥ä¾¦å¬DOMç‰¹å®šå­æ ‘ä¸Šçš„æ‰€æœ‰äº‹ä»¶ã€‚å¦‚æœè¦ä¾¦å¬é¡µé¢ä¸Šçš„æ‰€æœ‰äº‹ä»¶ï¼Œè¯·å°†äº‹ä»¶ä¾¦å¬å™¨é™„åŠ åˆ°windowå…ƒç´ ã€‚åœ¨ç¤ºä¾‹ä¸­ï¼Œblueï¼šbasketï¼šchanged-eventçš„åˆ›å»ºå¦‚ä¸‹æ‰€ç¤ºï¼š
```js
class BlueBuy extends HTMLElement {
  [...]
  connectedCallback() {
    [...]
    this.render();
    this.firstChild.addEventListener('click', this.addToCart);
  }
  addToCart() {
    // maybe talk to an api
    this.dispatchEvent(new CustomEvent('blue:basket:changed', {
      bubbles: true,
    }));
  }
  render() {
    this.innerHTML = `<button type="button">buy</button>`;
  }
  disconnectedCallback() {
    this.firstChild.removeEventListener('click', this.addToCart);
  }
}
```

ç°åœ¨ï¼Œè¿·ä½ è´­ç‰©ç¯®å¯ä»¥åœ¨çª—å£ä¸Šè®¢é˜…æ­¤äº‹ä»¶ï¼Œå¹¶åœ¨åˆ·æ–°æ•°æ®æ—¶å¾—åˆ°é€šçŸ¥ã€‚

```js
class BlueBasket extends HTMLElement {
  connectedCallback() {
    [...]
    window.addEventListener('blue:basket:changed', this.refresh);
  }
  refresh() {
    // fetch new data and render it
  }
  disconnectedCallback() {
    window.removeEventListener('blue:basket:changed', this.refresh);
  }
}
```
é€šè¿‡è¿™ç§æ–¹æ³•ï¼Œè¿·ä½ ç¯®ç‰‡æ®µå‘å…¶èŒƒå›´ï¼ˆçª—å£ï¼‰ä¹‹å¤–çš„DOMå…ƒç´ æ·»åŠ äº†ä¸€ä¸ªä¾¦å¬å™¨ã€‚å¯¹äºå¤§é‡çš„åº”ç”¨ç¨‹åºè¿™éƒ½æ²¡é—®é¢˜ï¼Œä½†æ˜¯å¦‚æœæ‚¨å¯¹æ­¤ä¸æ»¡æ„ï¼Œåˆ™è¿˜å¯ä»¥å®ç°ä¸€ç§æ–¹æ³•ï¼Œå…¶ä¸­é¡µé¢æœ¬èº«ï¼ˆå›¢é˜Ÿäº§å“ï¼‰ä¾¦å¬äº‹ä»¶å¹¶é€šè¿‡åœ¨DOMå…ƒç´ ä¸Šè°ƒç”¨refresh()é€šçŸ¥è¿·ä½ è´­ç‰©ç¯®ã€‚
```js
// page.js
const $ = document.getElementsByTagName;

$('blue-buy')[0].addEventListener('blue:basket:changed', function() {
  $('blue-basket')[0].refresh();
});
```

å¼ºåˆ¶æ€§åœ°è°ƒç”¨DOMæ–¹æ³•å¹¶ä¸å¸¸è§ï¼Œä½†æ˜¯å¯ä»¥åœ¨[video element api](https://developer.mozilla.org/de/docs/Web/HTML/Using_HTML5_audio_and_video#Controlling_media_playback)ä¸­æ‰¾åˆ°ã€‚ å¦‚æœå¯ä»¥ï¼Œåº”é¦–é€‰ä½¿ç”¨å£°æ˜å¼æ–¹æ³•ï¼ˆæ›´æ”¹å±æ€§ï¼‰ã€‚

## æœåŠ¡å™¨ç«¯æ¸²æŸ“/é€šç”¨æ¸²æŸ“
è‡ªå®šä¹‰å…ƒç´ éå¸¸é€‚åˆåœ¨æµè§ˆå™¨å†…éƒ¨é›†æˆç»„ä»¶ã€‚ä½†æ˜¯ï¼Œå½“æ„å»ºä¸€ä¸ªå¯åœ¨Webä¸Šè®¿é—®çš„ç«™ç‚¹æ—¶ï¼Œåˆå§‹è´Ÿè½½æ€§èƒ½å¾ˆå¯èƒ½ä¼šå˜å¾—å¾ˆé‡è¦ï¼Œå¹¶ä¸”åœ¨ä¸‹è½½å¹¶æ‰§è¡Œæ‰€æœ‰jsæ¡†æ¶ä¹‹å‰ï¼Œç”¨æˆ·å°†çœ‹åˆ°ç™½å±ã€‚å¦å¤–ï¼Œæœ€å¥½è€ƒè™‘ä¸€ä¸‹å¦‚æœJavaScriptå¤±è´¥æˆ–è¢«é˜»å¡ï¼Œç½‘ç«™ä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µã€‚[Jeremy Keith](https://adactio.com/)åœ¨å…¶ç”µå­ä¹¦/æ’­å®¢[Resilient Web Design](https://resilientwebdesign.com/)ä¸­è§£é‡Šäº†å…¶é‡è¦æ€§ã€‚å› æ­¤ï¼Œåœ¨æœåŠ¡å™¨ä¸Šå‘ˆç°æ ¸å¿ƒå†…å®¹çš„èƒ½åŠ›æ˜¯å…³é”®ã€‚ä¸å¹¸çš„æ˜¯ï¼ŒWebç»„ä»¶è§„èŒƒæ ¹æœ¬æ²¡æœ‰æ¶‰åŠæœåŠ¡å™¨æ¸²æŸ“ã€‚æ²¡æœ‰JavaScriptï¼Œæ²¡æœ‰è‡ªå®šä¹‰å…ƒç´ :(

## è‡ªå®šä¹‰å…ƒç´ +æœåŠ¡å™¨ç«¯åŒ…å«=â¤ï¸
ä¸ºäº†ä½¿æœåŠ¡å™¨æ¸²æŸ“æ­£å¸¸å·¥ä½œï¼Œé‡æ„äº†å‰é¢çš„ç¤ºä¾‹ã€‚æ¯ä¸ªå›¢é˜Ÿéƒ½æœ‰è‡ªå·±çš„expressæœåŠ¡å™¨ï¼Œè¿˜å¯ä»¥é€šè¿‡urlè®¿é—®Custom Elementçš„render()æ–¹æ³•ã€‚

```js
$ curl http://127.0.0.1:3000/blue-buy?sku=t_porsche
<button type="button">buy for 66,00 â‚¬</button>
```
â€œè‡ªå®šä¹‰å…ƒç´ â€æ ‡è®°åç§°ç”¨ä½œè·¯å¾„å-å±æ€§æˆä¸ºæŸ¥è¯¢å‚æ•°ã€‚ç°åœ¨ï¼Œæœ‰ä¸€ç§æ–¹æ³•å¯ä»¥é€šè¿‡æœåŠ¡å™¨æ¸²æŸ“æ¯ä¸ªç»„ä»¶çš„å†…å®¹ã€‚ç»“åˆ\<blue-buy \>-Custom Elementsï¼Œå¯ä»¥å®ç°ä¸é€šç”¨Webç»„ä»¶éå¸¸æ¥è¿‘çš„åŠŸèƒ½ï¼š
```js
<blue-buy sku="t_porsche">
  <!--#include virtual="/blue-buy?sku=t_porsche" -->
</blue-buy>
```

#includeæ³¨é‡Šæ˜¯[æœåŠ¡å™¨ç«¯åŒ…å«](https://en.wikipedia.org/wiki/Server_Side_Includes)çš„ä¸€éƒ¨åˆ†ï¼Œè¯¥åŠŸèƒ½åœ¨å¤§å¤šæ•°WebæœåŠ¡å™¨ä¸­éƒ½å¯ç”¨ã€‚æ˜¯çš„ï¼Œå°†å½“å‰æ—¥æœŸåµŒå…¥åˆ°æˆ‘ä»¬ç½‘ç«™ä¸Šï¼Œè¿™æ˜¯è¿‡å»ç»å¸¸ä½¿ç”¨çš„çš„ä¸€ç§æŠ€æœ¯ã€‚è¿˜æœ‰ä¸€äº›æ›¿ä»£æŠ€æœ¯ï¼Œä¾‹å¦‚[ESI](https://en.wikipedia.org/wiki/Edge_Side_Includes)ï¼Œ[nodesi](https://github.com/Schibsted-Tech-Polska/nodesi)ï¼Œ[compoxure](https://github.com/tes/compoxure)å’Œ[tailor](https://github.com/zalando/tailor)ï¼Œä½†æ˜¯å¯¹äºæˆ‘ä»¬çš„é¡¹ç›®ï¼ŒSSIå·²è¢«è¯æ˜æ˜¯ä¸€ç§ç®€å•ä¸”éš¾ä»¥ç½®ä¿¡çš„ç¨³å®šè§£å†³æ–¹æ¡ˆã€‚

åœ¨WebæœåŠ¡å™¨å°†å®Œæ•´é¡µé¢å‘é€åˆ°æµè§ˆå™¨ä¹‹å‰ï¼Œ#includeæ³¨é‡Šå°†æ›¿æ¢ä¸º/ blue-buy?sku=t_porscheçš„å“åº”ã€‚nginxä¸­çš„é…ç½®å¦‚ä¸‹æ‰€ç¤ºï¼š
```js
upstream team_blue {
  server team_blue:3001;
}
upstream team_green {
  server team_green:3002;
}
upstream team_red {
  server team_red:3003;
}

server {
  listen 3000;
  ssi on;

  location /blue {
    proxy_pass  http://team_blue;
  }
  location /green {
    proxy_pass  http://team_green;
  }
  location /red {
    proxy_pass  http://team_red;
  }
  location / {
    proxy_pass  http://team_red;
  }
}
```
æŒ‡ä»¤ssiï¼šon; å¯ç”¨SSIåŠŸèƒ½ï¼Œå¹¶ä¸ºæ¯ä¸ªå›¢é˜Ÿæ·»åŠ ä¸Šæ¸¸å’Œä½ç½®å—ï¼Œä»¥ç¡®ä¿å°†æ‰€æœ‰ä»¥/blueå¼€å¤´çš„urlè·¯ç”±åˆ°æ­£ç¡®çš„åº”ç”¨ç¨‹åºï¼ˆteam_blueï¼š3001ï¼‰ã€‚å¦å¤–ï¼Œ/è·¯ç”±æ˜ å°„åˆ°çº¢è‰²é˜Ÿï¼Œè¯¥çº¢è‰²é˜Ÿæ§åˆ¶ç€ä¸»é¡µ/äº§å“é¡µé¢ã€‚

æ­¤åŠ¨ç”»åœ¨ç¦ç”¨äº†JavaScriptçš„æµè§ˆå™¨ä¸­æ˜¾ç¤ºäº†æ‹–æ‹‰æœºå•†åº—ã€‚

![Serverside Rendering - Disabled JavaScript](https://micro-frontends.org/ressources/video/server-render.gif)

[inspect the code](https://github.com/neuland/micro-frontends/tree/master/2-composition-universal)

ç°åœ¨ï¼Œå˜ä½“é€‰æ‹©æŒ‰é’®æ˜¯å®é™…çš„é“¾æ¥ï¼Œæ¯æ¬¡å•å‡»éƒ½ä¼šå¯¼è‡´é¡µé¢é‡æ–°åŠ è½½ã€‚å³ä¾§çš„ç»ˆç«¯è¯´æ˜äº†å¦‚ä½•å°†é¡µé¢è¯·æ±‚è·¯ç”±åˆ°çº¢è‰²å›¢é˜Ÿï¼Œè¯¥å›¢é˜Ÿæ§åˆ¶äº§å“é¡µé¢ï¼Œç„¶åç”¨è“è‰²å’Œç»¿è‰²å›¢é˜Ÿçš„ç‰‡æ®µè¡¥å……æ ‡è®°ã€‚

é‡æ–°æ‰“å¼€JavaScriptæ—¶ï¼Œä»…ç¬¬ä¸€ä¸ªè¯·æ±‚çš„æœåŠ¡å™¨æ—¥å¿—æ¶ˆæ¯å¯è§ã€‚åƒç¬¬ä¸€ä¸ªç¤ºä¾‹ä¸€æ ·ï¼Œæ‰€æœ‰åç»­çš„æ‹–æ‹‰æœºæ›´æ”¹éƒ½ç”±å®¢æˆ·ç«¯å¤„ç†ã€‚åœ¨åé¢çš„ç¤ºä¾‹ä¸­ï¼Œäº§å“æ•°æ®å°†ä»JavaScriptä¸­æå–ï¼Œå¹¶æ ¹æ®éœ€è¦é€šè¿‡REST APIåŠ è½½ã€‚

æ‚¨å¯ä»¥åœ¨æœ¬åœ°è®¡ç®—æœºä¸Šä½¿ç”¨æ­¤ç¤ºä¾‹ä»£ç ã€‚ ä»…éœ€è¦å®‰è£…[Docker Compose](https://docs.docker.com/compose/install/)ã€‚

```js
git clone https://github.com/neuland/micro-frontends.git
cd micro-frontends/2-composition-universal
docker-compose up --build
```

ç„¶åï¼ŒDockeråœ¨ç«¯å£3000ä¸Šå¯åŠ¨Nginxï¼Œå¹¶ä¸ºæ¯ä¸ªå›¢é˜Ÿæ„å»ºnode.jsæ˜ åƒã€‚åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€[http://127.0.0.1:3000/](http://127.0.0.1:3000/)æ—¶ï¼Œåº”è¯¥ä¼šçœ‹åˆ°ä¸€ä¸ªçº¢è‰²çš„æ‹–æ‹‰æœºã€‚docker-composeçš„ç»„åˆæ—¥å¿—å¯è½»æ¾æŸ¥çœ‹ç½‘ç»œä¸­æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…ã€‚é—æ†¾çš„æ˜¯ï¼Œæ— æ³•æ§åˆ¶è¾“å‡ºé¢œè‰²ï¼Œå› æ­¤æ‚¨å¿…é¡»å¿å—ä»¥ä¸‹äº‹å®ï¼šè“è‰²å›¢é˜Ÿå¯èƒ½ä¼šä»¥ç»¿è‰²çªå‡ºæ˜¾ç¤ºï¼š)

srcæ–‡ä»¶æ˜ å°„åˆ°å„ä¸ªå®¹å™¨ä¸­ï¼Œå¹¶ä¸”åœ¨æ›´æ”¹ä»£ç åï¼ŒèŠ‚ç‚¹åº”ç”¨ç¨‹åºå°†é‡æ–°å¯åŠ¨ã€‚æ›´æ”¹nginx.confè¦æ±‚é‡æ–°å¯åŠ¨docker-composeæ‰èƒ½ç”Ÿæ•ˆã€‚å› æ­¤ï¼Œéšæ—¶éšæ„æ‘†å¼„å¹¶æä¾›åé¦ˆã€‚

## æ•°æ®è·å–å’ŒåŠ è½½çŠ¶æ€
SSI/ESIæ–¹æ³•çš„ç¼ºç‚¹æ˜¯ï¼Œæœ€æ…¢çš„ç‰‡æ®µç¡®å®šæ•´ä¸ªé¡µé¢çš„å“åº”æ—¶é—´ã€‚å› æ­¤ï¼Œæœ€å¥½æ˜¯å¯ä»¥ç¼“å­˜ç‰‡æ®µçš„å“åº”ã€‚å¯¹äºåˆ¶ä½œæˆæœ¬é«˜ä¸”éš¾ä»¥ç¼“å­˜çš„ç‰‡æ®µï¼Œé€šå¸¸æœ€å¥½å°†å…¶ä»åˆå§‹æ¸²æŸ“ä¸­æ’é™¤ã€‚ å¯ä»¥å°†å®ƒä»¬å¼‚æ­¥åŠ è½½åˆ°æµè§ˆå™¨ä¸­ã€‚åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œç»¿è‰²ä¸ªæ€§åŒ–ç‰‡æ®µæ˜¾ç¤ºäº†ä¸ªæ€§åŒ–æ¨èï¼Œè¿™æ˜¯ä¸€ä¸ªå¤‡é€‰æ–¹æ¡ˆã€‚

ä¸€ç§å¯èƒ½çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œçº¢è‰²å›¢é˜Ÿä»…è·³è¿‡SSI Includeã€‚

### ä¹‹å‰
```html
<green-recos sku="t_porsche">
  <!--#include virtual="/green-recos?sku=t_porsche" -->
</green-recos>
```
### ä¹‹å
```html
<green-recos sku="t_porsche"></green-recos>
```

é‡è¦è¯´æ˜ï¼šè‡ªå®šä¹‰å…ƒç´ [æ— æ³•è‡ªåŠ¨å…³é—­](https://developers.google.com/web/fundamentals/architecture/building-components/customelements#jsapi)ï¼Œå› æ­¤ç¼–å†™\<green-recos sku="t_porsche" /\>æ— æ³•æ­£å¸¸å·¥ä½œã€‚

[Reflow](https://micro-frontends.org/ressources/video/data-fetching-reflow.gif)

æ¸²æŸ“ä»…åœ¨æµè§ˆå™¨ä¸­è¿›è¡Œã€‚ä½†æ˜¯ï¼Œä»åŠ¨ç”»ä¸­å¯ä»¥çœ‹å‡ºï¼Œæ­¤æ›´æ”¹ç°åœ¨å¯¼è‡´é¡µé¢çš„å¤§é‡é‡æ’ã€‚æ¨èåŒºåŸŸæœ€åˆæ˜¯ç©ºç™½çš„ã€‚å›¢é˜Ÿæœå²­JavaScriptå·²åŠ è½½å¹¶æ‰§è¡Œã€‚è¿›è¡Œäº†ç”¨äºè·å–ä¸ªæ€§åŒ–æ¨èçš„APIè°ƒç”¨ã€‚å‘ˆç°æ¨èæ ‡è®°ï¼Œå¹¶è¯·æ±‚å…³è”çš„å›¾åƒã€‚ç°åœ¨ï¼Œè¯¥ç‰‡æ®µéœ€è¦æ›´å¤šç©ºé—´å¹¶æ¨åŠ¨é¡µé¢å¸ƒå±€ã€‚

æœ‰ä¸åŒçš„é€‰æ‹©æ¥é¿å…åƒè¿™æ ·ä»¤äººè®¨åŒçš„é‡æ’ã€‚å»ºè®®æ§åˆ¶é¡µé¢çš„çº¢è‰²å°ç»„å¯ä»¥å›ºå®šå®¹å™¨çš„é«˜åº¦ã€‚åœ¨å“åº”å¼ç½‘ç«™ä¸Šï¼Œç¡®å®šé«˜åº¦é€šå¸¸å¾ˆæ£˜æ‰‹ï¼Œå› ä¸ºä¸åŒçš„å±å¹•å°ºå¯¸å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚ä½†æ˜¯æ›´é‡è¦çš„é—®é¢˜æ˜¯ï¼Œè¿™ç§å›¢é˜Ÿé—´åè®®åœ¨çº¢è‰²å’Œç»¿è‰²å›¢é˜Ÿä¹‹é—´å»ºç«‹äº†ç´§å¯†çš„è”ç³»ã€‚å¦‚æœç»¿è‰²å›¢é˜Ÿå¸Œæœ›åœ¨recoå…ƒç´ ä¸­æ·»åŠ å…¶ä»–å­æ ‡é¢˜ï¼Œåˆ™å¿…é¡»ä¸çº¢è‰²å›¢é˜Ÿåœ¨æ–°é«˜åº¦ä¸Šè¿›è¡Œåè°ƒã€‚ä¸¤ä¸ªå›¢é˜Ÿéƒ½å¿…é¡»åŒæ—¶æ¨å‡ºä»–ä»¬çš„æ›´æ”¹ï¼Œä»¥é¿å…å¸ƒå±€æ··ä¹±ã€‚

æ›´å¥½çš„æ–¹æ³•æ˜¯ä½¿ç”¨ä¸€ç§ç§°ä¸º[éª¨æ¶å±](https://blog.prototypr.io/luke-wroblewski-introduced-skeleton-screens-in-2013-through-his-work-on-the-polar-app-later-fd1d32a6a8e7)ã€‚çº¢è‰²å°ç»„å°†ç»¿è‰²recos SSIåŒ…æ‹¬åœ¨æ ‡è®°ä¸­ã€‚æ­¤å¤–ï¼Œå›¢é˜Ÿç»¿è‰²æ›´æ”¹äº†å…¶ç‰‡æ®µçš„æœåŠ¡å™¨ç«¯æ¸²æŸ“æ–¹æ³•ï¼Œä»¥ä¾¿ç”Ÿæˆå†…å®¹çš„ç¤ºæ„å›¾ã€‚éª¨æ¶æ ‡è®°å¯ä»¥é‡ç”¨å®é™…å†…å®¹çš„éƒ¨åˆ†å¸ƒå±€æ ·å¼ã€‚è¿™æ ·ï¼Œå®ƒå¯ä»¥ä¿ç•™æ‰€éœ€çš„ç©ºé—´ï¼Œå¹¶ä¸”å®é™…å†…å®¹çš„å¡«å……ä¸ä¼šå¯¼è‡´è·³è½¬ã€‚

![Skeleton Screen](https://micro-frontends.org/ressources/video/data-fetching-skeleton.gif)

éª¨æ¶å±å¹•å¯¹äºå®¢æˆ·ç«¯æ¸²æŸ“ä¹Ÿéå¸¸æœ‰ç”¨ã€‚å½“æ‚¨çš„è‡ªå®šä¹‰å…ƒç´ ç”±äºç”¨æˆ·æ“ä½œè€Œæ’å…¥DOMæ—¶ï¼Œå®ƒå¯ä»¥ç«‹å³æ¸²æŸ“æ¡†æ¶ï¼Œç›´åˆ°ä»æœåŠ¡å™¨éœ€è¦çš„æ•°æ®åˆ°è¾¾ä¸ºæ­¢ã€‚

å³ä½¿åœ¨è¯¸å¦‚å˜é‡é€‰æ‹©ä¹‹ç±»çš„å±æ€§æ›´æ”¹ä¸Šï¼Œæ‚¨ä¹Ÿå¯ä»¥å†³å®šåˆ‡æ¢åˆ°æ¡†æ¶è§†å›¾ï¼Œç›´åˆ°æ–°æ•°æ®åˆ°è¾¾ã€‚è¿™æ ·ï¼Œç”¨æˆ·å¯ä»¥å¾—åˆ°ç‰‡æ®µä¸­æ­£åœ¨å‘ç”ŸæŸäº›äº‹æƒ…çš„æŒ‡ç¤ºã€‚ä½†æ˜¯ï¼Œå½“ç«¯ç‚¹å¿«é€Ÿå“åº”æ—¶ï¼Œæ–°æ—§æ•°æ®ä¹‹é—´çš„çŸ­æš‚éª¨æ¶é—ªçƒä¹Ÿå¯èƒ½å¾ˆçƒ¦äººã€‚ä¿ç•™æ—§æ•°æ®æˆ–ä½¿ç”¨æ™ºèƒ½è¶…æ—¶å¯ä»¥æœ‰æ‰€å¸®åŠ©ã€‚å› æ­¤ï¼Œè¯·æ˜æ™ºåœ°ä½¿ç”¨æ­¤æŠ€æœ¯ï¼Œå¹¶å°è¯•è·å–ç”¨æˆ·åé¦ˆã€‚

## åœ¨é¡µé¢ä¹‹é—´å¯¼èˆª
å³å°†ç»§ç»­â€¦â€¦ï¼ˆæˆ‘ä¿è¯ï¼‰

å…³æ³¨[Github Repo](https://github.com/neuland/micro-frontends)ä»¥è·å¾—é€šçŸ¥

## å…¶ä»–èµ„æº
- [Book: Micro Frontends in Action](https://www.manning.com/books/micro-frontends-in-action?a_aid=mfia&a_bid=5f09fdeb)ç”±æˆ‘ç¼–å†™ã€‚
- [Talk: Micro Frontends - MicroCPH, Copenhagen 2019](https://www.youtube.com/watch?v=wCHYILvM7kU)ï¼ˆ[å¹»ç¯ç‰‡](https://noti.st/naltatis/zQb2m5/micro-frontends-the-nitty-gritty-details-of-frontend-backend-happyend)ï¼‰Nitty Gritty Detailsæˆ–Frontendï¼ŒBackendï¼ŒğŸŒˆHappyend
- [Talk: Micro Frontends - Web Rebels, Oslo 2018](https://www.youtube.com/watch?v=dTW7eJsIHDg)ï¼ˆ[å¹»ç¯ç‰‡](https://noti.st/naltatis/HxcUfZ/micro-frontends -è®¤ä¸ºæ›´å°ï¼Œé¿å…æ•´ä½“å¼çš„çˆ±åç«¯)ï¼‰æ›´å°çš„æ€è€ƒï¼Œé¿å…æ•´ä½“å¼çš„ï¼Œâ¤ï¸åç«¯
- [Slides: Micro Frontends - JSUnconf.eu 2017](https://speakerdeck.com/naltatis/micro-frontends-building-a-modern-webapp-with-multiple-teams)
- [Talk: Break Up With Your Frontend Monolith - JS Kongress 2017](https://www.youtube.com/watch?v=W3_8sxUurzA)Elisabeth Engelåœ¨gutefrage.netä¸Šè®¨è®ºäº†å®ç°Micro Frontendsçš„é—®é¢˜ã€‚
- [Articleï¼šMicro Frontends](https://martinfowler.com/articles/micro-frontends.html)Cam Jacksonåœ¨Martin Fowlersåšå®¢ä¸Šçš„æ–‡ç« 
- [Post: Micro frontends - a microservice approach to front-end web development](https://medium.com/@tomsoderlund/micro-frontends-a-microservice-approach-to-front-end-web-development-f325ebdadc16)TomSÃ¶derlundè§£é‡Šäº†æ ¸å¿ƒæ¦‚å¿µå¹¶æä¾›äº†ä¸æ­¤ä¸»é¢˜ç›¸å…³çš„é“¾æ¥
- [Post: Microservices to Micro-Frontends](http://www.agilechamps.com/microservices-to-micro-frontends/)Sandeep Jainæ€»ç»“äº†å¾®æœåŠ¡å’Œå¾®å‰ç«¯èƒŒåçš„ä¸»è¦åŸç†
- [Link Collection: Micro Frontends by Elisabeth Engel](https://micro-frontends.zeef.com/elisabeth.engel?ref=elisabeth.engel&share=ee53d51a914b4951ae5c94ece97642fc)å¤§é‡æœ‰å…³æ­¤ä¸»é¢˜çš„å¸–å­ï¼Œè®²åº§ï¼Œå·¥å…·å’Œå…¶ä»–èµ„æº
- [Awesome Micro Frontends](https://github.com/ChristianUlbrich/awesome-microfrontends)Christian Ulbrichç²¾å¿ƒç­–åˆ’çš„é“¾æ¥åˆ—è¡¨cur
- [Custom Elements Everywhere](https://custom-elements-everywhere.com/)ç¡®ä¿æ¡†æ¶å’Œè‡ªå®šä¹‰å…ƒç´ å¯ä»¥æ˜¯BFF
- å¯åœ¨[manufactum.com](https://www.manufactum.com/)ä¸Šè´­ä¹°æ‹–æ‹‰æœºï¼š)
è¿™å®¶å•†åº—æ˜¯ç”±ä¸¤ä¸ªå›¢é˜Ÿä½¿ç”¨æ­¤å¤„ä»‹ç»çš„æŠ€æœ¯å¼€å‘çš„ã€‚

## å³å°†å‘ç”Ÿçš„äº‹æƒ…â€¦â€¦ï¼ˆå¾ˆå¿«ï¼‰
- ç”¨ä¾‹
   - åœ¨é¡µé¢ä¹‹é—´å¯¼èˆª
     - è½¯å¯¼èˆªä¸ç¡¬å¯¼èˆª
     - é€šç”¨è·¯ç”±å™¨
   - â€¦
- ä¸»é¢˜
   - éš”ç¦»çš„CSS /ä¸€è‡´çš„ç”¨æˆ·ç•Œé¢/æ ·å¼æŒ‡å—å’Œæ ·å¼åº“
   - åˆå§‹è´Ÿè½½ä¸‹çš„æ€§èƒ½
   - ä½¿ç”¨ç½‘ç«™æ—¶çš„è¡¨ç°
   - åŠ è½½CSS
   - åŠ è½½JS
   - é›†æˆæµ‹è¯•
   - â€¦

## è´¡çŒ®è€…
- [Koike Takayuki](https://github.com/koiketakayuki)å°†ç½‘ç«™ç¿»è¯‘ä¸º[æ—¥è¯­](https://micro-frontends-japanese.org/)ã€‚
- [JorgeBeltrÃ¡n](https://github.com/scipion)ï¼Œå°†ç½‘ç«™ç¿»è¯‘ä¸º[è¥¿ç­ç‰™æ–‡](https://micro-frontends-es.org/)ã€‚
- [Bruno Carneiro](https://github.com/Tautorn)å°†ç½‘ç«™ç¿»è¯‘ä¸º[è‘¡è„ç‰™è¯­](https://tautorn.github.io/micro-frontends/)ã€‚

è¯¥ç«™ç‚¹ç”±Github Pagesç”Ÿæˆã€‚ å®ƒçš„æ¥æºå¯ä»¥åœ¨[neuland/micro-frontends](https://github.com/neuland/micro-frontends/)ä¸Šæ‰¾åˆ°ã€‚